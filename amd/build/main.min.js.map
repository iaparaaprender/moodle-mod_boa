{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JS to connect with BoA repositories.\n *\n * @module     mod_boa/main\n * @copyright  2024 David Herney @ BambuCo\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/templates',\n        'core/log',\n        'core/ajax',\n        'mod_boa/util'],\n    function($,\n            ModalFactory,\n            ModalEvents,\n            Templates,\n            Log,\n            Ajax,\n            BoAUtil) {\n\n    var $errorBox = null;\n\n    var global = {\n        \"selected\": [],\n        \"socialnetworks\": [],\n        \"boasources\": []\n    };\n\n    // Load strings.\n    var strings = [\n        {key: 'noresultsfound', component: 'mod_boa'},\n        {key: 'removeselected', component: 'mod_boa'},\n        {key: 'saved', component: 'mod_boa'},\n        {key: 'notsaved', component: 'mod_boa'}\n    ];\n    var s = [];\n\n    $.boasearch = function(el, params) {\n        var $boasearch = $(el);\n        var $boasearchBox;\n        var $boasearchSuggestions = $('<ul class=\"boasearch-suggestions\"></ul>');\n        var cacheResults = [];\n        var requestObjects = [];\n        var startRecord = 0;\n\n        for (var i = 0; i < params.apiuris.length; i++) {\n            cacheResults[i] = [];\n        }\n\n        $boasearch.wrap('<span class=\"boasearch-box\"></span>');\n\n        $boasearchBox = $boasearch.parent();\n        $boasearchBox.append($boasearchSuggestions);\n\n        $boasearchSuggestions.customReset = function() {\n            $boasearchSuggestions.empty();\n            $boasearchSuggestions.hide();\n            $boasearchSuggestions.data('off', true);\n        };\n\n        $boasearchSuggestions.customReset();\n\n        if (params.options) {\n            params.options = $.extend({}, $.boasearch.defaults.options, params.options);\n        }\n\n        if (params.events) {\n            params.events = $.extend({}, $.boasearch.defaults.events, params.events);\n        }\n\n        if (params.results) {\n            params.results = $.extend({}, $.boasearch.defaults.results, params.results);\n        }\n\n        $boasearch.conf = $.extend({}, $.boasearch.defaults, params);\n\n        $boasearch.attr('autocomplete', 'off');\n\n        var ferror = function(txt, level) {\n            switch (level) {\n                case 'dev':\n                    if ($boasearch.conf.debug) {\n                        Log.debug('BoASearch - ' + txt);\n                    }\n                break;\n                default:\n                    Log.debug('BoASearch - ' + txt);\n            }\n        };\n\n        // Store a reference to the BoASearch object.\n        $.data(el, \"boasearch\", $boasearch);\n\n        // Private methods.\n        var methods = {\n            init: function() {\n                if (!$boasearch.conf.apiuris || typeof $boasearch.conf.apiuris !== 'object') {\n                    ferror('Configuration error: You need set the API URIs.');\n                    return;\n                }\n\n                $boasearch.on('keypress', function(event) {\n                    if (event.keyCode) {\n                        switch (event.keyCode) {\n                            case 13: // Enter\n                                event.preventDefault();\n                                $boasearchSuggestions.customReset();\n                                break;\n                            case 27: // Escape\n                                $boasearchSuggestions.customReset();\n                                break;\n                            case 38: // Up\n                                if (!$boasearchSuggestions.data('off')) {\n                                    methods.previousItemMarkup();\n                                }\n                                break;\n                            case 40: // Down\n                                if (!$boasearchSuggestions.data('off')) {\n                                    methods.nextItemMarkup();\n                                }\n                                break;\n                        }\n                    }\n                });\n\n                $boasearch.on('keyup', function(event) {\n                    var val = $boasearch.val();\n\n                    var specialKeys = [13, 16, 17, 18, 27, 33, 34, 35, 36, 37, 38, 39, 45, 144];\n                    if (!$boasearchSuggestions.data('off')) {\n                        specialKeys[specialKeys.length] = 40;\n                    }\n\n                    if (event.keyCode && specialKeys.indexOf(event.keyCode) == -1) {\n                        if (val.length >= $boasearch.conf.options.minLetters) {\n                            $boasearch.printSuggestions(val);\n                        } else {\n                            $boasearchSuggestions.customReset();\n                        }\n                    } else if (event.keyCode === 13) {\n                        $boasearch.search();\n                    }\n                });\n\n                $boasearchBox.on('focusout', function() {\n                    window.setTimeout(function() {\n                        $boasearchSuggestions.customReset();\n                    }, 100);\n                });\n            },\n\n            /**\n             * Build a suggestion item\n             *\n             * @param {object} item the current item data to render\n             * @param {string} query the last query submited to the server.\n             */\n            getItemMarkup: function(item, query) {\n                var text = item.query != '' ? methods.highlightString(item.query, query) : '';\n\n                var $item = $('<li>' + text + '</li>');\n\n                $item.on('click', function() {\n                    var $this = $(this);\n                    $boasearchSuggestions.customReset();\n                    $boasearch.val($this.text());\n                });\n\n                return $item;\n            },\n\n            highlightString: function(str, query) {\n                var n = str.toLowerCase().indexOf(query.toLowerCase());\n                if (n >= 0) {\n                    var before = str.substr(0, n);\n                    var word = str.substr(n, query.length);\n                    var after = str.substr(n + query.length);\n\n                    str = before + '<em>' + word + '</em>' + after;\n                }\n                return str;\n            },\n\n            nextItemMarkup: function() {\n                var $current = $boasearchSuggestions.find('.current');\n                var oldposition, newposition;\n\n                if ($current.length < 1) {\n                    oldposition = -1;\n                } else {\n                    oldposition = $current.index();\n                }\n\n                newposition = oldposition + 1;\n\n                if ($boasearchSuggestions.find('> li').length <= newposition) {\n                    newposition = 0;\n                }\n\n                $current.removeClass('current');\n                var $new = $boasearchSuggestions.children().eq(newposition);\n\n                $new.addClass('current');\n                $boasearch.val($new.text());\n            },\n\n            previousItemMarkup: function() {\n                var $current = $boasearchSuggestions.find('.current');\n                var oldposition, newposition;\n\n                if ($current.length < 1) {\n                    oldposition = -1;\n                } else {\n                    oldposition = $current.index();\n                }\n\n                newposition = oldposition - 1;\n\n                if (newposition < 0) {\n                    newposition = $boasearchSuggestions.find('> li').length - 1;\n                }\n\n                $current.removeClass('current');\n                var $new = $boasearchSuggestions.children().eq(newposition);\n\n                $new.addClass('current');\n                $boasearch.val($new.text());\n            },\n\n            printItemsMarkup: function(title, data, query) {\n\n                if (data.length > 0) {\n                    $.each(data, function(k, item) {\n                        var $item = methods.getItemMarkup(item, query, k);\n                        $boasearchSuggestions.append($item);\n                    });\n\n                    $boasearchSuggestions.show();\n                    $boasearchSuggestions.data('off', false);\n                }\n            },\n\n            initSearch: function() {\n                if (typeof $boasearch.conf.events.onstart == 'function') {\n                    $boasearch.conf.events.onstart(startRecord > 0);\n                } else {\n                    if ($boasearch.conf.results.target) {\n                        $($boasearch.conf.results.target).addClass('loading');\n                        if (startRecord === 0) {\n                            $($boasearch.conf.results.target).empty();\n                        }\n                    }\n                }\n            },\n\n            printResultSearch: function(uriIndex, data) {\n\n                if (typeof $boasearch.conf.events.onfound == 'function') {\n                    $boasearch.conf.events.onfound(uriIndex, data, startRecord);\n                } else {\n                    if ($boasearch.conf.results.target) {\n                        var $target = $($boasearch.conf.results.target);\n                        $target.removeClass('loading');\n\n                        $.each(data, function(k, item) {\n                            var $html = $('<div class=\"boa-video\"></div>');\n                            var preview = BoAUtil.choosePreview(item);\n                            $html.append('<a href=\"' + item.about + '\"><h5>' + item.metadata.general.title.none + '</h5></a>');\n                            $html.append('<a href=\"' + item.about + '\"><img src=\"' + preview + '.img\" /></a>');\n                            $html.append('<p>' + item.metadata.general.description.none + '</p>');\n\n                            $target.append($html);\n                        });\n                    }\n                }\n            }\n\n        };\n\n        // Public methods\n        $boasearch.printSuggestions = function(query) {\n\n            for (var request in requestObjects) {\n                if (request && typeof request === 'object') {\n                    request.abort();\n                }\n            }\n\n            $boasearchSuggestions.customReset();\n            requestObjects = [];\n\n            // Use the first API URIs for query suggestions.\n            var uri = $boasearch.conf.apiuris[0].uri;\n            uri = uri.substr(0, uri.indexOf('/resources'));\n            uri += '/queries.json';\n\n            var params = {\n                \"q\": query,\n                \"(n)\": $boasearch.conf.options.suggestionsSize\n            };\n\n            if ($boasearch.conf.filters.length > 0) {\n                var filters = $boasearch.conf.filters.join(' AND ');\n                params.filter = filters;\n            }\n\n            // Not for specific catalogues yet.\n            var cataloguename = '';\n            requestObjects[requestObjects.length] = $.get(uri, params, function(data) {\n\n                if (data.length > 0) {\n                    data.sort(function(a, b) {\n                        return b.size - a.size;\n                    });\n\n                    methods.printItemsMarkup(cataloguename, data, query);\n                }\n            });\n        };\n\n        $boasearch.search = function(catalogueIndex = null) {\n\n            var currentTime = Date.now();\n\n            var query = $boasearch.val();\n\n            if (query.length < $boasearch.conf.options.minLetters) {\n                return false;\n            }\n\n            methods.initSearch();\n\n            for (var cacheIndex = 0; cacheIndex < cacheResults.length; cacheIndex++) {\n                if (cacheResults[cacheIndex][query]\n                        && cacheResults[cacheIndex][query].timeQuery > (currentTime - $boasearch.conf.options.cacheLife)) {\n                    methods.printResultSearch(cacheIndex, cacheResults[query].data);\n                    return true;\n                }\n\n                cacheResults[cacheIndex][query] = {\n                    timeQuery: currentTime,\n                    data: []\n                };\n            }\n\n            var params = {\n                \"q\": query,\n                \"(n)\": $boasearch.conf.options.resultsSize,\n                \"(s)\": startRecord\n            };\n\n            if ($boasearch.conf.filters.length > 0) {\n                $.each($boasearch.conf.filters, function(k, filter) {\n                    if (typeof filter.value == 'object') {\n                        $.each(filter.value, function(m, val) {\n                            params['(meta)[' + filter.meta + '][' + m + ']'] = val;\n                        });\n                    } else {\n                        params['(meta)[' + filter.meta + ']'] = filter.value;\n                    }\n                });\n            }\n\n            for (var uriIndex = 0; uriIndex < $boasearch.conf.apiuris.length; uriIndex++) {\n\n                if (catalogueIndex !== null && catalogueIndex !== uriIndex) {\n                    continue;\n                }\n\n                $.ajax({\n                    url: $boasearch.conf.apiuris[uriIndex].uri,\n                    data: params,\n                    uriIndex: uriIndex,\n                    dataType: 'json',\n                    success: function(data) {\n                        $boasearchSuggestions.empty();\n\n                        if (typeof data === 'object' && data.error) {\n                            $boasearch.conf.events.onerror(data);\n                            data = [];\n                        }\n\n                        if (data.length > 0) {\n                            data.sort(function(a, b) {\n                                return b.size - a.size;\n                            });\n\n                            cacheResults[this.uriIndex][query].data = data;\n\n                        }\n\n                        methods.printResultSearch(this.uriIndex, data);\n                    },\n                    error: function(xhr) {\n                        var data = xhr.responseText;\n                        $boasearch.conf.events.onerror($.parseJSON(data));\n                    },\n                    fail: function(xhr) {\n                        var data = xhr.responseText;\n                        $boasearch.conf.events.onerror($.parseJSON(data));\n                    }\n                });\n            }\n\n            return true;\n\n        };\n\n        $boasearch.searchMore = function(catalogueIndex) {\n            startRecord += $boasearch.conf.options.resultsSize;\n            $boasearch.search(catalogueIndex);\n        };\n\n        $boasearch.restart = function() {\n            startRecord = 0;\n        };\n\n        // BoA: Initialize.\n        methods.init();\n    };\n\n    // BoA: Default Settings.\n    $.boasearch.defaults = {\n        apiuri: null,\n        catalogues: [],\n        filters: [],\n        options: {\n            suggestionsSize: 10,\n            resultsSize: 10,\n            minLetters: 3,\n            cacheLife: 60000 // 60 seconds\n        },\n        debug: false,\n        results: {\n            target: null,\n            template: null\n        },\n        events: {\n            onstart: null,\n            onfound: null,\n            onerror: function(error) {\n                Log.debug('BoASearch - search error');\n                Log.debug(error);\n                return true;\n            }\n        }\n    };\n\n    // BoA: Plugin Function.\n    $.fn.boasearch = function(params, paramval) {\n        if (params === undefined) {\n            params = {};\n        }\n\n        if (typeof params === \"object\") {\n            return this.each(function() {\n                new $.boasearch(this, params);\n            });\n        } else {\n\n            var $boasearch = null;\n\n            if ('data' in this) {\n                $boasearch = this.data('boasearch');\n            } else {\n\n                if ('data' in $(this)) {\n                    $boasearch = $(this).data('boasearch');\n                }\n            }\n\n            if ($boasearch) {\n\n                switch (params) {\n                    case \"search\": $boasearch.search(); break;\n                    case \"nextsearch\": $boasearch.searchMore(paramval); break;\n                    case \"option\": return $boasearch.conf.options[paramval];\n                    case \"restart\": $boasearch.restart(); break;\n                    case \"choosePreview\": return BoAUtil.choosePreview(paramval);\n                }\n            } else {\n                Log.debug('Error in boasearch object');\n            }\n        }\n\n        return true;\n    };\n\n    var binditem = function($item) {\n\n        $item.find('[boa-href]').on('click', function() {\n            var $this = $(this);\n\n            var modalresource = $this.data('modal');\n\n            if (modalresource) {\n                modalresource.show();\n                return;\n            }\n\n            var request = $.get($this.attr('boa-href'))\n                .then(function(data) {\n\n                    var previewcontent = BoAUtil.chooseView(data);\n                    if (typeof previewcontent == 'object') {\n                        previewcontent = previewcontent.get(0).outerHTML;\n                    }\n\n                    data.custom = {};\n                    data.custom.preview = previewcontent;\n                    data.custom.type = (data.metadata.technical && data.metadata.technical.format) ?\n                                            data.metadata.technical.format : '';\n                    data.custom.score = 'avg' in data.social.score ?\n                                            data.social.score.avg + ' / ' + data.social.score.count : 0;\n                    data.custom.downloadable = BoAUtil.isDownloadable(data);\n                    data.about = encodeURI(data.about);\n\n                    var socialnetworksitems = [];\n                    $.each(global.socialnetworks, function(i, v) {\n                        var url = v.url.replace('{url}', encodeURI(data.about + '/!/'));\n                        url = url.replace('{name}', data.metadata.general.title.none);\n\n                        var item = {};\n                        item.url = url;\n                        item.icon = v.icon;\n                        socialnetworksitems.push(item);\n                    });\n\n                    data.custom.socialnetworks = socialnetworksitems;\n\n                    if (typeof data.metadata.general.keywords.none == 'object') {\n                        data.metadata.general.keywords.none = data.metadata.general.keywords.none.join(', ');\n                    }\n\n                    return Templates.render('mod_boa/viewresource', data);\n                })\n                .then(function(html) {\n\n                    var $html = $(html);\n                    $html.find('[data-addtoselection]').on('click', function() {\n                        var $thisobject = $(this);\n\n                        if (global.selected[$thisobject.data('addtoselection')]) {\n                            global.selected[$thisobject.data('addtoselection')].detach();\n                            delete global.selected[$thisobject.data('addtoselection')];\n                        } else {\n                            global.selected[$thisobject.data('addtoselection')] = $item;\n                            $thisobject.removeClass('btn-primary').addClass('btn-danger');\n                            $thisobject.find('span').html(s.removeselected);\n                            refreshadded();\n                        }\n                        $this.data('modal').hide();\n                    });\n\n                    return $html;\n                })\n                .catch(function(error) {\n                    Log.debug(error);\n                });\n\n            ModalFactory.create({\n                body: request.promise()\n            })\n            .then(function(modal) {\n                modalresource = modal;\n\n                if ($item.data('metadata')) {\n                    let itemdata = $item.data('metadata');\n                    modalresource.setTitle(itemdata.metadata.general.title.none);\n                }\n                modal.getModal().addClass('block_boasearch-modal');\n                modal.show();\n\n                var root = modal.getRoot();\n                root.on(ModalEvents.hidden, function() {\n\n                    // Stop audio and video when close the window.\n                    $(modal.getBody()).find('video').each(function() {\n                        this.pause();\n                    });\n\n                    $(modal.getBody()).find('audio').each(function() {\n                        this.pause();\n                    });\n\n                    $(modal.getBody()).find('iframe').each(function() {\n                        let $iframe = $(this);\n                        $iframe.attr('src', 'about:blank');\n                        $this.data('modal', null);\n                    });\n                });\n\n                $this.data('modal', modalresource);\n\n                return true;\n            })\n            .catch(function(error) {\n                Log.debug(error);\n            });\n\n        });\n\n    };\n\n    var refreshadded = function(change = true) {\n\n        var $container = $('#boa-currentselection > div.boa-items');\n        $container.children().detach();\n        $('#boa-currentselection > .alert').detach();\n\n        if (change) {\n            $('#boa-currentselection .boa-saveselection').show();\n        }\n\n        if (!global.selected) {\n            return;\n        }\n\n        for (var about in global.selected) {\n            let $item = global.selected[about];\n\n            if ($item) {\n                $container.append($item);\n                continue;\n            }\n\n            $.get(about)\n                .then(function(data) {\n                    data.thumb = BoAUtil.choosePreview(data);\n\n                    var $item = $(BoAUtil.itemContent(data));\n                    binditem($item);\n                    $item.data('metadata', data);\n                    global.selected[data.about] = $item;\n                    $container.append($item);\n                    return true;\n                })\n                .fail(function(e) {\n                    Log.debug('Error loading resource');\n                    Log.debug(e);\n                });\n\n        }\n    };\n\n    /**\n     * Initialise all for the block.\n     *\n     * @param {int} cmid The course module id.\n     * @param {array} boacatalogues The BoA API URIs.\n     * @param {int} pagesize The number of items to show.\n     * @param {array} socialnetworks The social networks to share.\n     */\n    var init = function(cmid, boacatalogues, pagesize, socialnetworks) {\n\n        pagesize = pagesize ? pagesize : 10;\n        global.socialnetworks = socialnetworks;\n\n        global.boasources = boacatalogues;\n\n        // The variable \"boacurrentselection\" comes from the template because it can be so large that it cannot be passed\n        // by parameters since it exceeds the limit for these values.\n        $.each(M.boacurrentselection, function(index, uri) {\n            global.selected[uri] = null;\n        });\n\n        s = BoAUtil.loadStrings(strings);\n\n        var $thisblock = $('#mod_boa-seachpagebox');\n        var $searchResult = $thisblock.find('[data-control=\"search-result\"]');\n        var $boaCatalogues = $thisblock.find('.boa-catalogues');\n        var $boaCataloguesTabs = $boaCatalogues.find('.nav-tabs');\n        var $boaCataloguesContent = $boaCatalogues.find('.tab-content');\n        var $boaSearch = $thisblock.find('[data-control=\"search-text\"]');\n        $errorBox = $thisblock.find('[data-control=\"errors-box\"]');\n\n        $thisblock.find('[data-control=\"search-button\"]').on('click', function() {\n            $thisblock.find('> .search-result .tab-pane > .boa-content').empty();\n            $boaSearch.boasearch('restart');\n            $boaSearch.boasearch('search');\n        });\n\n        $boaSearch.boasearch({\n            apiuris: global.boasources,\n            catalogues: [],\n            filters: [],\n            options: {\n                cacheLife: 2000,\n                resultsSize: pagesize\n            },\n            events: {\n                onstart: function(more) {\n                    $searchResult.addClass('loading');\n                    $searchResult.show();\n\n                    if (!more) {\n                        $searchResult.find('.tab-content > .tab-pane > .boa-content').empty();\n                        $boaCataloguesTabs.find('a:first').tab('show');\n                    }\n                },\n                onfound: function(catalogueIndex, data, start) {\n\n                    $searchResult.removeClass('loading');\n                    var $catalogue = $boaCataloguesContent.find('#boa-catalogue-' + catalogueIndex);\n                    var $target = $catalogue.find(' > .boa-content');\n\n                    var resultsSize = $boaSearch.boasearch('option', 'resultsSize');\n\n                    if (data.length === 0 || data.length < resultsSize) {\n                        $catalogue.find('> button').hide();\n                    } else {\n                        $catalogue.find('> button').show();\n                    }\n\n                    if (start == 0) {\n                        $thisblock.find('[data-control=\"show-one\"]').empty();\n                    }\n\n                    if ((!data || data.length === 0) && start == 0) {\n                        $target.empty();\n\n                        var content = BoAUtil.showMessage(s.noresultsfound);\n\n                        $target.append(content);\n                        return;\n                    }\n\n                    var availableItems = 0;\n                    $.each(data, function(k, item) {\n\n                        // Check if the item is already selected.\n                        if (global.selected[item.about]) {\n                            return;\n                        }\n\n                        availableItems++;\n\n                        if (item.manifest.conexion_type == 'external') {\n                            item.finaluri = item.manifest.url;\n                        } else {\n                            item.finaluri = item.about + '/!/';\n\n                            if (item.manifest.entrypoint) {\n                                item.finaluri += item.manifest.entrypoint;\n                            }\n                        }\n\n                        item.thumb = BoAUtil.choosePreview(item);\n\n                        var $item = $(BoAUtil.itemContent(item));\n                        $item.data('metadata', item);\n                        $item.appendTo($target);\n\n                        binditem($item);\n                    });\n\n                    if (start == 0 && availableItems === 0) {\n                        var content = BoAUtil.showMessage(s.noresultsfound);\n                        $target.append(content);\n                    }\n                },\n                onerror: function(error) {\n                    var $target = $errorBox;\n                    $target.empty();\n\n                    var $node = BoAUtil.showMessage(error.message, 'error', error.info);\n                    $target.append($node);\n\n                    Log.debug(error);\n\n                    $target.removeClass('loading');\n                }\n            }\n        });\n\n        $searchResult.find('.tab-pane').each(function(index, element) {\n            var $element = $(element);\n            $element.find('> button').on('click', function(event) {\n                event.preventDefault();\n                var $button = $(this);\n                $boaSearch.boasearch('nextsearch', $button.data('catalogueindex'));\n            });\n        });\n\n        var $saveselection = $('#boa-currentselection .boa-saveselection');\n        $saveselection.hide();\n        $saveselection.on('click', function() {\n            var $thisbutton = $(this);\n\n            var data = [];\n            for (var about in global.selected) {\n                data.push(about);\n            }\n\n            Ajax.call([{\n                methodname: 'mod_boa_select_resources',\n                args: {\n                    cmid: cmid,\n                    list: data\n                }\n            }])[0].then(function(data) {\n\n                if (data) {\n                    let $msg = BoAUtil.showMessage(s.saved, 'success');\n                    $saveselection.after($msg);\n                } else {\n                    let $msg = BoAUtil.showMessage(s.notsaved);\n                    $saveselection.after($msg);\n                }\n\n                $thisbutton.hide();\n\n                return true;\n            }).fail(function(e) {\n                Log.debug('Error saving resources selected');\n                Log.debug(e);\n            });\n        });\n\n        refreshadded(false);\n    };\n\n    return {\n        init: init\n    };\n});\n"],"names":["define","$","ModalFactory","ModalEvents","Templates","Log","Ajax","BoAUtil","$errorBox","global","strings","key","component","s","boasearch","el","params","$boasearchBox","$boasearch","$boasearchSuggestions","cacheResults","requestObjects","startRecord","i","apiuris","length","wrap","parent","append","customReset","empty","hide","data","options","extend","defaults","events","results","conf","attr","methods","init","txt","level","debug","on","event","keyCode","preventDefault","previousItemMarkup","nextItemMarkup","val","specialKeys","indexOf","minLetters","printSuggestions","search","window","setTimeout","getItemMarkup","item","query","text","highlightString","$item","$this","this","str","n","toLowerCase","before","substr","word","after","newposition","$current","find","index","removeClass","$new","children","eq","addClass","printItemsMarkup","title","each","k","show","initSearch","onstart","target","printResultSearch","uriIndex","onfound","$target","$html","preview","choosePreview","about","metadata","general","none","description","request","abort","uri","suggestionsSize","filters","join","filter","get","sort","a","b","size","catalogueIndex","currentTime","Date","now","cacheIndex","timeQuery","cacheLife","resultsSize","value","m","meta","ajax","url","dataType","success","error","onerror","xhr","responseText","parseJSON","fail","searchMore","restart","apiuri","catalogues","template","fn","paramval","undefined","binditem","modalresource","then","previewcontent","chooseView","outerHTML","custom","type","technical","format","score","social","avg","count","downloadable","isDownloadable","encodeURI","socialnetworksitems","socialnetworks","v","replace","icon","push","keywords","render","html","$thisobject","selected","detach","removeselected","refreshadded","catch","create","body","promise","modal","itemdata","setTitle","getModal","getRoot","hidden","getBody","pause","change","$container","thumb","itemContent","e","cmid","boacatalogues","pagesize","boasources","M","boacurrentselection","loadStrings","$thisblock","$searchResult","$boaCatalogues","$boaCataloguesTabs","$boaCataloguesContent","$boaSearch","more","tab","start","$catalogue","availableItems","manifest","conexion_type","finaluri","entrypoint","appendTo","content","showMessage","noresultsfound","$node","message","info","element","$button","$saveselection","$thisbutton","call","methodname","args","list","$msg","saved","notsaved"],"mappings":"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"}